(window.webpackJsonp=window.webpackJsonp||[]).push([[112],{527:function(e,t,o){"use strict";o.r(t),o.d(t,"chat_iframe",(function(){return n})),o.d(t,"host_check",(function(){return h})),o.d(t,"online_chat",(function(){return r}));var c=o(96);const h=class{constructor(e){Object(c.g)(this,e),this.show=!1,this.error=!1,this.hostList=[]}onSelect(e,t){const o=e.target.checked;this.hostList[t].checked=o,this.refreshList(),this.saveActiveKeys(),o?this.fetchEnv(t):this.hostList[t].hosts_list=this.hostList[t].hosts_list.map(e=>Object.assign(Object.assign({},e),{success:void 0}))}saveActiveKeys(){const e=this.hostList.filter(e=>e.checked).map(e=>e.id);window.localStorage.setItem("HOST_ACTIVE_KEYS",JSON.stringify(e))}async fetchEnv(e){const t=this.hostList[e];if(!t.hosts_list.length)return;const o=t.hosts_list.map(async e=>{const t=await fetch(`//${e.domain}/envs`);return await t.json()}),c=await Promise.allSettled(o);t.hosts_list=t.hosts_list.map((e,t)=>{const o="fulfilled"===c[t].status?c[t].value.env:void 0;return Object.assign(Object.assign({},e),{success:"staging"===o})}),this.refreshList()}refreshList(){this.hostList=[...this.hostList]}async goClearDNSCache(){await navigator.clipboard.writeText("chrome://net-internals/#sockets"),alert("已复制地址，点击确定后请在新开的页面粘贴该地址后点击 Close idle sockets 或 Flush socket pools"),window.open("chrome://net-internals/#sockets")}hostListWatcher(e){this.error=e.filter(e=>e.checked).some(e=>e.hosts_list.some(e=>!1===e.success))}async componentWillLoad(){const e=JSON.parse(localStorage.getItem("HOST_ACTIVE_KEYS")||"[]"),t=await fetch("//oray-hosts.oraybeta.com/hosts/oray/staging-requirements"),o=await t.json()||[];this.hostList=o.map(t=>Object.assign(Object.assign({},t),{checked:e.includes(t.id)})),this.hostList.forEach((e,t)=>{e.checked&&this.fetchEnv(t)})}toggleVisible(){this.show=!this.show}close(){document.querySelector("host-check").remove()}render(){return Object(c.e)(c.a,null,Object(c.e)("div",{class:{"host-check-wrapper":!0,show:this.show}},Object(c.e)("div",{class:"host-check-header"},Object(c.e)("div",{class:"operation"},Object(c.e)("button",{onClick:this.goClearDNSCache},"想清缓存点我",this.show),Object(c.e)("a",{href:"//oray-hosts.oraybeta.com/hosts-mgr",target:"_blank"},"去设置Host"),Object(c.e)("a",{onClick:this.close},"关闭")),Object(c.e)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",onClick:this.toggleVisible.bind(this)},Object(c.e)("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M7.05709 8.00186L2.81445 3.75922L3.75726 2.81641L7.9999 7.05905L12.2425 2.81641L13.1854 3.75922L8.94271 8.00186L13.1854 12.2445L12.2425 13.1873L7.9999 8.94466L3.75726 13.1873L2.81445 12.2445L7.05709 8.00186Z",fill:"#4E5969"}))),Object(c.e)("div",{class:"host-check-body"},this.hostList.map((e,t)=>Object(c.e)("div",{class:{"host-item":!0,show:e.checked},key:e.id},Object(c.e)("h5",null,Object(c.e)("label",null,Object(c.e)("input",{type:"checkbox",checked:e.checked,onChange:e=>this.onSelect(e,t)}),e.title)),Object(c.e)("ul",null,e.hosts_list.map(e=>Object(c.e)("li",{class:{success:e.success,error:!1===e.success}},e.ip," ",e.domain))))))),Object(c.e)("div",{class:{"host-check-icon":!0,error:this.error,show:!this.show},onClick:this.toggleVisible.bind(this)},Object(c.e)("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},Object(c.e)("path",{d:"M863.9 96.45H160.67c-34.42 0-62.57 28.16-62.57 62.57 0 34.42 28.16 62.57 62.57 62.57H863.9c34.42 0 62.57-28.16 62.57-62.57 0.01-34.41-28.15-62.57-62.57-62.57zM863.9 331.69H499.07c-34.42 0-62.57 28.16-62.57 62.57 0 34.42 28.16 62.57 62.57 62.57H863.9c34.42 0 62.57-28.16 62.57-62.57 0.01-34.41-28.15-62.57-62.57-62.57zM863.9 567.16H499.07c-34.42 0-62.57 28.16-62.57 62.57 0 34.42 28.16 62.57 62.57 62.57H863.9c34.42 0 62.57-28.16 62.57-62.57 0.01-34.41-28.15-62.57-62.57-62.57zM863.9 802.85H160.67c-34.42 0-62.57 28.16-62.57 62.57 0 34.42 28.16 62.57 62.57 62.57H863.9c34.42 0 62.57-28.16 62.57-62.57 0.01-34.41-28.15-62.57-62.57-62.57zM108.41 539.36L304.03 686.3c20.96 15.74 50.89 0.79 50.89-25.42V363.12c0-26.4-30.31-41.3-51.21-25.18L108.09 488.75c-16.64 12.83-16.49 37.99 0.32 50.61z",fill:"currentColor","p-id":"9433"}))))}static get watchers(){return{hostList:["hostListWatcher"]}}};h.style=":host{position:fixed;right:0;bottom:50%;z-index:999999;transform:translateY(50%)}p,ul,li,h5{margin:0;padding:0}ul,li{list-style:none}a{text-decoration:none}.host-check-wrapper{width:400px;height:400px;max-width:100vw;display:none;box-shadow:0 2px 15px rgba(0, 0, 0, 0.1);border-top-left-radius:12px;border-bottom-left-radius:12px;padding:12px;background-color:#fff;flex-direction:column}.host-check-wrapper .host-check-header{display:flex;justify-content:space-between;align-items:center;padding:6px 0 12px;background-color:#fff}.host-check-wrapper .host-check-header>svg{cursor:pointer}.host-check-wrapper .host-check-header .operation{display:flex}.host-check-wrapper .host-check-header .operation>*{margin-right:10px;cursor:pointer}.host-check-wrapper .host-check-body{flex:1;overflow-y:auto}.host-check-wrapper .host-check-body .host-item{margin-bottom:12px}.host-check-wrapper .host-check-body .host-item>h5>label{cursor:pointer;font-size:14px;display:flex;align-items:center;user-select:none}.host-check-wrapper .host-check-body .host-item>h5>label input[type=checkbox]{margin-right:6px}.host-check-wrapper .host-check-body .host-item>ul{display:none;margin-top:6px;padding:6px 0;background-color:#f6f6f6}.host-check-wrapper .host-check-body .host-item>ul>li{font-size:14px;text-indent:1.5em}.host-check-wrapper .host-check-body .host-item>ul>li:not(:first-child){margin-top:4px}.host-check-wrapper .host-check-body .host-item>ul>li.success{color:green}.host-check-wrapper .host-check-body .host-item>ul>li.error{color:red}.host-check-wrapper .host-check-body .host-item.show>ul{display:block}.host-check-wrapper.show{display:flex}.host-check-icon{display:none;width:50px;height:50px;cursor:pointer;color:#1A56D2;position:relative}.host-check-icon.error{animation:host-error infinite 0.5s}.host-check-icon.error::after{content:'这里出错了！！！！！！！！！！！！！！！！！！';white-space:nowrap;display:block;color:#fff;position:absolute;top:-10px;right:2px;transform:translateY(-100%);padding:10px;background-color:rgba(0, 0, 0, 0.6);border-radius:6px}.host-check-icon.show{display:block}@keyframes host-error{0%{color:#1A56D2}100%{color:red}}";const r=class{constructor(e){Object(c.g)(this,e),this.brand_id=void 0,this.showIframe=!1}async open(){this.showIframe=!0}close(){this.showIframe=!1}componentDidLoad(){window.onlineChatClick=this.open.bind(this)}render(){return Object(c.e)(c.a,null,Object(c.e)("div",{class:"online-chat-bnt",onClick:this.open.bind(this)},Object(c.e)("slot",null,Object(c.e)("span",null,"在线客服"))),!0===this.showIframe?Object(c.e)("chat-iframe",{brand_id:this.brand_id,onCloseEvent:this.close.bind(this)}):Object(c.e)("div",null))}};r.style=":host{z-index:999999}.online-chat-bnt span{cursor:pointer}";const n=class{constructor(e){Object(c.g)(this,e),this.closeEvent=Object(c.c)(this,"closeEvent",7),this.brand_id=void 0}close(){this.closeEvent.emit()}async componentDidLoad(){document.body.appendChild(this.el)}getUrl(){switch(this.brand_id){case 2:return"https://url.oray.com/d/chat?brand_id=2";case 3:return"https://url.oray.com/d/chat?brand_id=3";case 4:return"https://url.oray.com/d/chat?brand_id=4";default:return"https://url.oray.com/d/chat"}}render(){return Object(c.e)(c.a,null,Object(c.e)("div",{class:"iframe-box",id:"draggable"},Object(c.e)("div",{class:"iframe-header"},Object(c.e)("svg",{class:"close-icon",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",onClick:this.close.bind(this)},Object(c.e)("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M7.05709 8.00186L2.81445 3.75922L3.75726 2.81641L7.9999 7.05905L12.2425 2.81641L13.1854 3.75922L8.94271 8.00186L13.1854 12.2445L12.2425 13.1873L7.9999 8.94466L3.75726 13.1873L2.81445 12.2445L7.05709 8.00186Z",fill:"#4E5969"}))),Object(c.e)("iframe",{src:this.getUrl(),class:"iframe-wrap"})))}get el(){return Object(c.d)(this)}};n.style=":host{z-index:9999}.iframe-box{width:480px;height:600px;z-index:99999;position:fixed;bottom:0;right:0;overflow:hidden;background:#fff;border-radius:10px;box-shadow:0 0 20px 0 rgba(0, 0, 0, 0.15)}.iframe-box .iframe-header{position:absolute;height:48px;width:100%;cursor:move}.iframe-box .iframe-header .close-icon{position:absolute;right:0;height:48px;padding-right:12px;cursor:pointer}.iframe-box .iframe-wrap{width:100%;height:100%;border:none;z-index:999999}@media (max-width: 831px){.iframe-box{width:100%;height:100%}}"}}]);
//# sourceMappingURL=7c84b91fdf02ba9e5db9.js.map